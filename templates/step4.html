<!DOCTYPE html>
<html lang="en">

<head>
    {#    <meta charset="UTF-8">#}
    {#    <meta http-equiv="X-UA-Compatible" content="IE=edge">#}
    {#    <meta name="viewport" content="width=device-width, initial-scale=1.0">#}
    {#    <link rel="stylesheet" href="../static/fonts/material-design-iconic-font/css/material-design-iconic-font.css">#}
    {##}
    {#    <!-- DATE-PICKER -->#}
    {#    <link rel="stylesheet" href="../static/vendor/date-picker/css/datepicker.min.css">#}
    {##}
    {#    <!-- STYLE CSS -->#}
    {#    <link rel="stylesheet" href="../static/css/step3.css">#}

    <link rel="canonical" href="https://getbootstrap.com/docs/5.2/examples/dashboard/">
    <link href="../static/css/bootstrap-5.2.0-css/bootstrap.min.css" rel="stylesheet">
    <link href="../static/css/step4.css" rel="stylesheet">

    <title>Body Virtualisation APP - Health Report</title>

    <script type="importmap">
        {
            "imports": {
            "three": "https://unpkg.com/three@0.143.0/build/three.module.js"
            }
        }
    </script>

    <script type="module" src="/static/js/THREEControllerS4_before.js"></script>
    <script type="module" src="/static/js/THREEControllerS4_after.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <script src="https://rawgit.com/moment/moment/2.2.1/min/moment.min.js"></script>
</head>

<body>
    <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
        <div>
            
            <h1 class="h2"> Your Health Report </h1>
            <hr>
        </div>

        <div class="comparison">
            <h2> Part 1. Model Comparison</h2>
            <hr>
            <div id="before_canvas">
                <!-- <img src="../static/images/fake_step4_1.jpg" alt="">
                老模型 -->
            </div>

            <div id="after_canvas">
                <!-- <img src="../static/images/fake_step4_2.jpg" alt=""> -->
                <!-- 最新模型 -->
            </div>
        </div>

        <h2> Weight Changes </h2>
        <div>
            <canvas id="weight_chart" width="600" height="300"></canvas>
            <script>
            function retract_records_data(records, key ){
                var toBeAppendedList = []
                for (let i = 0; i < records.length; i++){
                    toBeAppendedList.push(records[i][key])
                }
                return toBeAppendedList
            }

            var historic_records = {{ historic_records|safe }}
            var weights = retract_records_data(historic_records, "weight")
            var dates = retract_records_data(historic_records, "update_time")

            const ctx = document.getElementById('weight_chart').getContext('2d');
            const weightChangeChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: dates,
                    datasets: [{
                        label: 'Weight',
                        data: weights,
                        fill:true,
                        borderColor: ['rgb(75, 192, 192)'],
                    }]
                },
                options: {
                     scales: {
                       yAxes: {
                            ticks: {
                                callback: function(value, index, ticks) {
                                return value+" kg";
                                }
                            }
                        }
                    },
                    responsive: false

                }
            });


        </script>
        </div>

        <h2> BMI Changes</h2>
        <div>
            <canvas id="bmi_chart" width="600" height="300"></canvas>
            <script>
              var labels = dates
              var bmi_records = {{bmi_records|safe}}
              const data = {
                labels: labels,
                datasets: [{
                  label: 'BMI',
                  borderColor: 'rgb(255, 99, 132)',
                  fill:true,
                  data: bmi_records
                }]
              };

              const config = {
                type: 'line',
                data: data,
                options: {
                    responsive:false
                }
              };
              const bmiChangeChart = new Chart(
                    document.getElementById('bmi_chart'),
                    config
                );
            </script>
        </div>



        <h2> Part 2. Statistics Report</h2>
        <hr>

        <!--  折线图 -->
        <canvas class="my-4 w-100" id="myChart" width="900" height="380"></canvas>

        <h2>Part 3. History Statistics</h2>
        <hr>
        <div class="table-responsive">
            <table class="table table-striped table-sm">
                <thead>
                    <tr>
                        <th scope="col">#</th>
                        <th scope="col">BMI</th>
                        <th scope="col">Fat Rate</th>
                        <th scope="col">B/W/S</th>
                        <th scope="col">blabla</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1,001</td>
                        <td>random</td>
                        <td>data</td>
                        <td>placeholder</td>
                        <td>text</td>
                    </tr>
                    <tr>
                        <td>1,002</td>
                        <td>placeholder</td>
                        <td>irrelevant</td>
                        <td>visual</td>
                        <td>layout</td>
                    </tr>
                    <tr>
                        <td>1,003</td>
                        <td>data</td>
                        <td>rich</td>
                        <td>dashboard</td>
                        <td>tabular</td>
                    </tr>
                    <tr>
                        <td>1,003</td>
                        <td>information</td>
                        <td>placeholder</td>
                        <td>illustrative</td>
                        <td>data</td>
                    </tr>
                    <tr>
                        <td>1,004</td>
                        <td>text</td>
                        <td>random</td>
                        <td>layout</td>
                        <td>dashboard</td>
                    </tr>
                    <tr>
                        <td>1,005</td>
                        <td>dashboard</td>
                        <td>irrelevant</td>
                        <td>text</td>
                        <td>placeholder</td>
                    </tr>
                    <tr>
                        <td>1,006</td>
                        <td>dashboard</td>
                        <td>illustrative</td>
                        <td>rich</td>
                        <td>data</td>
                    </tr>
                    <tr>
                        <td>1,007</td>
                        <td>placeholder</td>
                        <td>tabular</td>
                        <td>information</td>
                        <td>irrelevant</td>
                    </tr>
                    <tr>
                        <td>1,008</td>
                        <td>random</td>
                        <td>data</td>
                        <td>placeholder</td>
                        <td>text</td>
                    </tr>
                    <tr>
                        <td>1,009</td>
                        <td>placeholder</td>
                        <td>irrelevant</td>
                        <td>visual</td>
                        <td>layout</td>
                    </tr>
                    <tr>
                        <td>1,010</td>
                        <td>data</td>
                        <td>rich</td>
                        <td>dashboard</td>
                        <td>tabular</td>
                    </tr>
                    <tr>
                        <td>1,011</td>
                        <td>information</td>
                        <td>placeholder</td>
                        <td>illustrative</td>
                        <td>data</td>
                    </tr>
                    <tr>
                        <td>1,012</td>
                        <td>text</td>
                        <td>placeholder</td>
                        <td>layout</td>
                        <td>dashboard</td>
                    </tr>
                    <tr>
                        <td>1,013</td>
                        <td>dashboard</td>
                        <td>irrelevant</td>
                        <td>text</td>
                        <td>visual</td>
                    </tr>
                    <tr>
                        <td>1,014</td>
                        <td>dashboard</td>
                        <td>illustrative</td>
                        <td>rich</td>
                        <td>data</td>
                    </tr>
                    <tr>
                        <td>1,015</td>
                        <td>random</td>
                        <td>tabular</td>
                        <td>information</td>
                        <td>text</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </main>
    </div>
    <script src="../static/js/bootstrap-5.2.0-js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons@4.28.0/dist/feather.min.js"
        integrity="sha384-uO3SXW5IuS1ZpFPKugNNWqTZRRglnUJK6UAZ/gxOX80nxEkN9NcGZTftn6RzhGWE" crossorigin="anonymous">
    </script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"
        integrity="sha384-zNy6FEbO50N+Cg5wap8IKA4M/ZnLJgzc6w2NqACZaK0u0FXfOWRRJOnQtpZun8ha" crossorigin="anonymous">
    </script>
    <script src="../static/js/dashboard.js"></script>


    <!-- Buttons -->
    <form class="last" action="" method='POST'>
        <button>
            Step 3
        </button>
    </form>

    <form class="logout" action="" method='GET'>
        <button>
            Logout
        </button>
    </form>


</body>

</html>