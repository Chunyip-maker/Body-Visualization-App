<!DOCTYPE html>
{% include 'flashed_message.html' %}
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../static/fonts/material-design-iconic-font/css/material-design-iconic-font.css">

    <!-- DATE-PICKER -->
    <link rel="stylesheet" href="../static/vendor/date-picker/css/datepicker.min.css">

    <!-- STYLE CSS -->
    <link rel="stylesheet" href="../static/css/step3.css">
    <title>Body Virtualisation APP - Step 3</title>

    <script type="importmap">
        {
            "imports": {
            "three": "https://unpkg.com/three@0.143.0/build/three.module.js"
            }
        }
    </script>

    <script type="module" src="/static/js/THREEController.js"></script>
</head>

<body>

    <div id="preloader">



    </div>




    <p id="hair_color" style="display: none">{{ model_texture[0] }}</p>
    <p id="skin_color" style="display: none">{{ model_texture[1] }}</p>
    <p id="top_dress" style="display: none">{{ model_texture[2] }}</p>
    <p id="bottom_dress" style="display: none">{{ model_texture[3] }}</p>
    <p id="model_path" style="display: none">{{ model_texture[4] }}</p>
    <p id="check_new_model" style="display: none">{{ model_parameters[0] }}</p>


    {#    <p id="height" style="display: none">{{ model_parameters[1] }}</p>#}
    {#    <p id="weight" style="display: none">{{ model_parameters[2] }}</p>#}
    {#    <p id="thigh" style="display: none">{{ model_parameters[3] }}#}
    {#    <p id="shank" style="display: none">{{ model_parameters[4] }}</p>#}
    {#    <p id="hip" style="display: none">{{ model_parameters[5] }}</p>#}
    {#    <p id="arm_girth" style="display: none">{{ model_parameters[6] }}</p>#}
    {#    <p id="arm_pan" style="display: none">{{ model_parameters[7] }}</p>#}
    {#    <p id="waist" style="display: none">{{ model_parameters[8] }}</p>#}
    {#    <p id="chest" style="display: none">{{ model_parameters[9] }}</p>#}





    <!-- Title -->
    <div class="main_title">
        Customise your model!
    </div>


    <!-- Main Area -->
    <form class="next" action="/step3" method='POST'>
        <div class="main">
            <div id="canvas">

            </div>


            <div class="right">
                <div class="slider-box">
                    <div class="slider">
                        <input type="range" name="height" min={{ body_parameters_range[1] }}
                            max={{ body_parameters_range[2]}} value={{model_parameters[1]}} class="slider" id="a1"
                            step="0.5">
                    </div>
                    <span id="b1">{{model_parameters[1]}}</span>
                    <span>height</span>
                </div>



                <div class="slider-box">
                    <div class="slider">
                        <input type="range" name="weight" min={{ body_parameters_range[3] }}
                            max={{ body_parameters_range[4]}} value={{model_parameters[2]}} class="slider" id="a2"
                            step="0.5">
                    </div>
                    <span id="b2">{{model_parameters[2]}}</span>
                    <span>weight</span>
                </div>

                <div class="slider-box">
                    <div class="slider">
                        <input type="range" name="chest" min={{ body_parameters_range[5] }}
                            max={{ body_parameters_range[6]}} value={{model_parameters[3]}} class="slider" id="a3"
                            step="0.5">
                    </div>

                    <span id="b3">{{model_parameters[3]}}</span>
                    <span>chest</span>
                </div>


                <div class="slider-box">
                    <div class="slider">
                        <input type="range" name="waist" min={{ body_parameters_range[7] }}
                            max={{ body_parameters_range[8]}} value={{model_parameters[4]}} class="slider" id="a4"
                            step="0.5">

                    </div>

                    <span id="b4">{{model_parameters[4]}}</span>
                    <span>waist</span>
                </div>


                <div class="slider-box">
                    <div class="slider">
                        <input type="range" name="hip" min={{ body_parameters_range[9] }}
                            max={{ body_parameters_range[10]}} value={{model_parameters[5]}} class="slider" id="a5"
                            step="0.5">

                    </div>
                    <span id="b5">{{model_parameters[5]}}</span>
                    <span>hip</span>
                </div>



                <div class="slider-box">
                    <div class="slider">

                        <input type="range" name="Arm girth" min={{ body_parameters_range[11] }}
                            max={{ body_parameters_range[12]}} value={{model_parameters[6]}} class="slider" id="a6"
                            step="0.5">

                    </div>
                    <span id="b6">{{model_parameters[6]}}</span>
                    <span>arm girth</span>
                </div>

                <div class="slider-box">
                    <div class="slider">

                        <input type="range" name="Arms pan" min={{ body_parameters_range[13] }}
                            max={{ body_parameters_range[14]}} value={{model_parameters[7]}} class="slider" id="a7"
                            step="0.5">

                    </div>
                    <span id="b7">{{model_parameters[7]}}</span>
                    <span>arms pan</span>
                </div>


                <div class="slider-box">
                    <div class="slider">
                        <input type="range" name="thigh" min={{ body_parameters_range[15] }}
                            max={{ body_parameters_range[16]}} value={{model_parameters[8]}} class="slider" id="a8"
                            step="0.5">

                    </div>
                    <span id="b8">{{model_parameters[8]}}</span>
                    <span>thigh</span>
                </div>



                <div class="slider-box">
                    <div class="slider">
                        <input type="range" name="shank" min={{ body_parameters_range[17] }}
                            max={{ body_parameters_range[18]}} value={{model_parameters[9]}} class="slider" id="a9"
                            step="0.5">
                    </div>
                    <span id="b9">{{model_parameters[9]}}</span>
                    <span>shank</span>
                </div>


                <!-- buttons -->
                <div class="button">
                    <form class="next" action="/step3" method='POST'>
                        <button>
                            Next
                        </button>
                    </form>

                    <!-- 改成history的 -->
                    <form class="history" action="/step4" method='GET'>
                        <button>
                            History
                        </button>
                    </form>
                </div>
            </div>


            <script>
                const rangeInputs = document.querySelectorAll('input[type="range"]')
                const numberInput = document.querySelector('input[type="number"]')

                function handleInputChange(e) {
                    let target = e.target
                    if (e.target.type !== 'range') {
                        target = document.getElementById('range')
                    }
                    const min = target.min
                    const max = target.max
                    const val = target.value

                    target.style.backgroundSize = (val - min) * 100 / (max - min) + '% 100%'
                }

                rangeInputs.forEach(input => {
                    input.addEventListener('input', handleInputChange)
                })
            </script>

        </div>


        <form class="logout" action="/logout" method='GET'>
            <button>
                Logout
            </button>
        </form>




        <script>
            $(window).on("load", function () {
                $("#preloader").fadeOut("slow");
            });
        </script>






</body>

</html>