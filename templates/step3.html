<!DOCTYPE html>
{% include 'flashed_message.html' %}
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../static/fonts/material-design-iconic-font/css/material-design-iconic-font.css">

    <!-- DATE-PICKER -->
    <link rel="stylesheet" href="../static/vendor/date-picker/css/datepicker.min.css">

    <!-- STYLE CSS -->
    <link rel="stylesheet" href="../static/css/step3.css">
    <link rel="Bookmark" href="../static/images/muscle.png" />
    <link rel="shortcut icon" href="../static/images/muscle.png" />
    <link rel="icon" href="../static/images/muscle.png" />
    <title>Body Virtualisation APP - Step 3</title>

    <script type="importmap">
        {
            "imports": {
            "three": "https://unpkg.com/three@0.143.0/build/three.module.js"
            }
        }
    </script>

    <script type="module" src="/static/js/THREEController.js"></script>
</head>

<body>

    <div id="preloader">


    </div>
    <script>
    (function(){
    var myDiv = document.getElementById("preloader"),

      show = function(){
        myDiv.style.display = "block";
        setTimeout(hide, 5000); // 5 seconds
      },

      hide = function(){
        myDiv.style.display = "none";
      };

    show();
  })();
    </script>



    <p id="hair_color" style="display: none">{{ model_texture[0] }}</p>
    <p id="skin_color" style="display: none">{{ model_texture[1] }}</p>
    <p id="top_dress" style="display: none">{{ model_texture[2] }}</p>
    <p id="bottom_dress" style="display: none">{{ model_texture[3] }}</p>
    <p id="model_path" style="display: none">{{ model_texture[4] }}</p>
    <p id="check_new_model" style="display: none">{{ model_parameters[0] }}</p>

    <!-- Title -->
    <div class="top">
        <div class="main_title">
            Customise your model!
        </div>

    </div>

    <!-- Main Area -->

    <div class="main">
        <form class="logout" action="/logout" method='GET'>
            <button>
                Logout
            </button>
        </form>

        <div id="canvas">

        </div>


        <div class="right">
            <form action="/step3" method='POST'>

                <div class="slider-box">
                    <span>height (cm) </span>
                    <div class="slider">
                        <input type="range" name="height" min={{ body_parameters_range[1] }}
                            max={{ body_parameters_range[2]}} value={{model_parameters[1]}} class="slider" id="a1"
                            step="0.5">
                    </div>
                    <span id="b1">{{model_parameters[1]}}</span>

                </div>



                <div class="slider-box">
                    <span>weight (kg)</span>
                    <div class="slider">
                        <input type="range" name="weight" min={{ body_parameters_range[3] }}
                            max={{ body_parameters_range[4]}} value={{model_parameters[2]}} class="slider" id="a2"
                            step="0.5">
                    </div>
                    <span id="b2">{{model_parameters[2]}}</span>

                </div>

                <div class="slider-box">
                    <span>chest (cm)</span>
                    <div class="slider">
                        <input type="range" name="chest" min={{ body_parameters_range[5] }}
                            max={{ body_parameters_range[6]}} value={{model_parameters[3]}} class="slider" id="a3"
                            step="0.5">
                    </div>

                    <span id="b3">{{model_parameters[3]}}</span>
                </div>


                <div class="slider-box">
                    <span>waist (cm)</span>
                    <div class="slider">
                        <input type="range" name="waist" min={{ body_parameters_range[7] }}
                            max={{ body_parameters_range[8]}} value={{model_parameters[4]}} class="slider" id="a4"
                            step="0.5">

                    </div>

                    <span id="b4">{{model_parameters[4]}}</span>
                </div>


                <div class="slider-box">
                    <span>hip (cm)</span>
                    <div class="slider">
                        <input type="range" name="hip" min={{ body_parameters_range[9] }}
                            max={{ body_parameters_range[10]}} value={{model_parameters[5]}} class="slider" id="a5"
                            step="0.5">
                    </div>
                    <span id="b5">{{model_parameters[5]}}</span>

                </div>



                <div class="slider-box">
                    <span>arm girth (cm)</span>
                    <div class="slider">
                        
                        <input type="range" name="Arm girth" min={{ body_parameters_range[11] }}
                            max={{ body_parameters_range[12]}} value={{model_parameters[6]}} class="slider" id="a6"
                            step="0.5">

                    </div>
                    <span id="b6">{{model_parameters[6]}}</span>
                    
                </div>

                <div class="slider-box">
                    <span>arms pan (cm)</span>
                    <div class="slider">
                        
                        <input type="range" name="Arms pan" min={{ body_parameters_range[13] }}
                            max={{ body_parameters_range[14]}} value={{model_parameters[7]}} class="slider" id="a7"
                            step="0.5">

                    </div>
                    <span id="b7">{{model_parameters[7]}}</span>
                    
                </div>


                <div class="slider-box">
                    <span>thigh (cm)</span>
                    <div class="slider">
                        
                        <input type="range" name="thigh" min={{ body_parameters_range[15] }}
                            max={{ body_parameters_range[16]}} value={{model_parameters[8]}} class="slider" id="a8"
                            step="0.5">

                    </div>
                    <span id="b8">{{model_parameters[8]}}</span>
                    
                </div>



                <div class="slider-box">
                    <span>shank (cm)</span>
                    <div class="slider">
                        <input type="range" name="shank" min={{ body_parameters_range[17] }}
                            max={{ body_parameters_range[18]}} value={{model_parameters[9]}} class="slider" id="a9"
                            step="0.5">
                    </div>
                    <span id="b9">{{model_parameters[9]}}</span>
                    
                </div>
                <div class="next" id="next">
                    <button>
                        Submit
                    </button>
                </div>
            </form>

            <form class="history" id="history" action="/step3" method='POST'>
                <button>
                    History
                </button>
            </form>


            <script>
                var isNew = {{model_parameters[0]}} == 0;
                console.log(isNew)
                var h = document.getElementById('history');
                var next = document.getElementById('next');
                if (isNew == true) {
                    h.style.display = 'none';
                    next.style.cssFloat = 'left';
                    next.style.marginLeft = '125px';
                }
            </script>
        </div>
    </div>




    <script>
        const rangeInputs = document.querySelectorAll('input[type="range"]')
        const numberInput = document.querySelector('input[type="number"]')

        function handleInputChange(e) {
            let target = e.target
            if (e.target.type !== 'range') {
                target = document.getElementById('range')
            }
            const min = target.min
            const max = target.max
            const val = target.value

            target.style.backgroundSize = (val - min) * 100 / (max - min) + '% 100%'
        }

        rangeInputs.forEach(input => {
            input.addEventListener('input', handleInputChange)
        })
    </script>

    </div>




</body>

</html>